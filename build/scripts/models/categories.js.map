{"version":3,"sources":["categories.es6"],"names":[],"mappings":"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","file":"categories.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass */\r\n\r\n\r\nlet categories = {\r\n\t__constructor(){\r\n\t   return new Promise(function(_resolve){\r\n            pg.load.model('storage').then( r=>_resolve(r) );\r\n        });\r\n\t},\r\n\r\n\tpage( page = 0 , limit=10, sortBy = '' , order='DESC' ){\r\n        // get all items (clone array)\r\n        let items = JSON.parse( JSON.stringify(pg.models.storage.Data.categories) );\r\n\r\n        // TO DO : sort by key\r\n        // TO DO : apply ASC DESC order\r\n\r\n    \t// if a page is requested, slice array , and select only corresponding items\r\n        if(page > 0){\r\n        \tlet firstIndex = (page * limit) - limit;\r\n        \tlet lastIndex = (firstIndex + limit - 1) < items.length ? (firstIndex + limit ) : items.length ;\r\n        \titems = items.slice(firstIndex, lastIndex);\r\n        }\r\n        // done ! return items;\r\n        return items;\r\n    },\r\n\r\n    get(id='',original = false){\r\n\t\tlet i = categories.getIndexById(id);\r\n\t\treturn (i === -1) ? -1 :  ( original ? pg.models.storage.Data.categories[i] : JSON.parse( JSON.stringify(pg.models.storage.Data.categories[i]) ) );\r\n\t},\r\n\r\n\tgetByName(name){\r\n\t\tfor(let i = 0; i < pg.models.storage.Data.categories.length; i++){\r\n\t\t\tif(pg.models.storage.Data.categories[i].name === name) return pg.models.storage.Data.categories[i];\r\n\t\t}\r\n\t\treturn -1;\r\n\t},\r\n\r\n    delete(id=''){\r\n        return new Promise(function(resolve){\r\n\t    \tconsole.log('[Model]:categories.delete(): deleting feed #'+id);\r\n\t\t\t// get index in array\r\n\t\t\tlet i = categories.getIndexById(id);\r\n\t\t\t// block if  id NOT found\r\n\t\t\tif(i === -1) resolve(false);\r\n\t\t\t// remove item from Data array\r\n\t\t\tpg.models.storage.Data.categories.splice(i,1);\r\n\t\t\t// request to save new data\r\n\t\t\tpg.models.storage.sync.categories().then( r => resolve(true) );\r\n\t\t});\r\n    },\r\n\r\n\tsave( category ){\r\n        return new Promise(function(resolve){\r\n\t\t\tconsole.log('[Model]:categories.save(): saving category #' + category.id);\r\n\t\t\tlet i = categories.getIndexById(category.id);\r\n\t\t\tif(i === -1) i = pg.models.storage.Data.categories.length;\r\n\t\t\tpg.models.storage.Data.categories[i] = category;\r\n\t\t\tcategories.updateFeedCount();\r\n\t\t\tpg.models.storage.sync.categories().then( r => resolve(true) );\r\n        });\r\n\t},\r\n\r\n\tnew(){\r\n\t\treturn {\r\n\t\t\tid \t\t: pg.guid(),\r\n\t\t\tname \t: undefined,\r\n\t\t\tfeeds \t: 0\r\n\t\t};\r\n\t},\r\n\r\n\tupdateFeedCount(id=undefined){\r\n\t\tlet _update = function(id){\r\n\t\t\tlet category = categories.get(id);\r\n\t\t\tif(category === -1) return -1;\r\n\r\n\t\t\tcategory.feeds = 0;\r\n\t\t\tfor (let i=0; i < pg.models.storage.Data.feeds.length; i++ ) if(pg.models.storage.Data.feeds[i].categories.indexOf(id) !== -1) category.feeds++;\r\n\t\t\treturn category.feeds;\r\n\t\t};\r\n\t\tif(typeof id === 'undefined') for (let i=0; i < pg.models.storage.Data.categories.length; i++ ) _update( pg.models.storage.Data.categories[i].id );\r\n\t\telse _update( id );\r\n\t\treturn true;\r\n\t},\r\n\r\n\r\n\tgetIndexById(id){\r\n\t\treturn pg.models.storage.Data.categories.findIndex( category=>(category.id === id ) ? true : false );\r\n\t},\r\n};\r\n\r\nexport default categories;\r\n"]}