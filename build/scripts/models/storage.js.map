{"version":3,"sources":["storage.es6"],"names":[],"mappings":"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","file":"storage.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass */\r\n\r\n\r\nlet storage = {\r\n\t__constructor(){\r\n\t\treturn new Promise(resolve=>{\r\n\t\t\tpg.log('[Model]:storage.__constructor() : Preparing for Initial Data Syncronization...')\r\n\t\t\tchrome.storage.sync.get( 'feeds', f=>{\r\n\t\t\t\tchrome.storage.sync.get( 'categories', c=>{\r\n\t\t\t\t\tchrome.storage.sync.get( 'watchers', w=>{\r\n\t\t\t\t\t\tthis.Data.feeds \t=  f.feeds \t\t|| [];\r\n\t\t    \t\t\tthis.Data.categories=  c.categories || [];\r\n\t\t    \t\t\tthis.Data.watchers \t=  w.watchers \t|| [];\r\n\t\t\t\t\t\tpg.log('[Model]:storage.__constructor() : Data Sync done. ['+this.Data.feeds.length+'] Feeds | ['+this.Data.categories.length+'] Categories | ['+this.Data.watchers.length+'] Watchers')\r\n\t\t    \t\t\tresolve();\r\n\t\t\t    \t});\r\n\t\t    \t});\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n \tData : {\r\n        feeds : [],\r\n        watchers : [],\r\n        categories : []\r\n    },\r\n\r\n    onChange : (function(){\r\n\t\treturn chrome.storage.onChanged.addListener(function(changes, namespace) {\r\n\t\t\tfor (let key in changes) {\r\n\t\t\t\tif( !changes.hasOwnProperty(key) ) continue;\r\n\t\t\t\tvar storageChange = changes[key];\r\n\t\t\t\tconsole.log('Storage key \"%s\" in namespace \"%s\" changed. ' +\r\n\t\t\t\t          'Old value was \"%s\", new value is \"%s\".',\r\n\t\t\t\t          key,\r\n\t\t\t\t          namespace,\r\n\t\t\t\t          storageChange.oldValue,\r\n\t\t\t\t          storageChange.newValue);\r\n\t\t\t\t}\r\n\t\t});\r\n    })(),\r\n\tsync:{\r\n\t\tfeeds: function(){\r\n\t    \treturn new Promise(function(resolve){\r\n\t\t\t\tchrome.storage.sync.set({'feeds': storage.Data.feeds} , r=> resolve(true) );\r\n\t\t    });\r\n\t\t},\r\n\t\tcategories: function(){\r\n\t\t    pg.log('pg.models.storage.get.categories(): Getting Categories (useCached='+useCached+')');\r\n\t\t    return new Promise(function(_resolve){\r\n\t\t    \tif( !useCached || !storage.Data.categories ){\r\n\t\t    \t\tchrome.storage.sync.get( 'categories', r=>{\r\n\t\t\t    \t\tstorage.Data.categories =  r.categories || [];\r\n\t\t\t    \t\t_resolve( storage.Data.categories );\r\n\t\t\t    \t});\r\n\t\t        }else _resolve(storage.Data.categories);\r\n\t\t    });\r\n\t\t},\r\n\t\twatchers: function(){\r\n\t\t    pg.log('pg.models.storage.get.watchers(): Getting Watchers (useCached='+useCached+')');\r\n\t\t    return new Promise(function(_resolve){\r\n\t\t    \tif( !useCached || !storage.Data.watchers ){\r\n\t\t    \t\tchrome.storage.sync.get( 'watchers', r=>{\r\n\t\t\t    \t\tstorage.Data.watchers =  r.watchers || [];\r\n\t\t\t    \t\t_resolve( storage.Data.watchers );\r\n\t\t\t    \t});\r\n\t\t        }else _resolve(storage.Data.watchers);\r\n\t\t    });\r\n\t\t}\r\n\t},\r\n\tset: {}\r\n};\r\n\r\nexport default storage;\r\n"]}