{"version":3,"sources":["app.es6"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass, app */\r\n\r\n// let main extends pg.__Controller{\r\nlet app ={\r\n\t__constructor(){\r\n\t\treturn new Promise( (resolve,reject) =>{\r\n\t\t\tpg.log('*** Starting Torrent Observer v.' + pg.getVersion() );\r\n\r\n\t\t\t// require module libraries\r\n\t\t\tpg.log('main.__constructor() : Requiring JSON.parseXML...');\r\n\t\t\tpg.require('lib/JSON.parseXML').then( r => {\r\n\t  \t\t\tthis.countFeedsinAllCategories();\r\n\t\t\t\tthis.getAllFeeds().then( r => {\r\n\t\t\t\t\tresolve( );\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tlocation : 'categories',\r\n\r\n\tData : {\r\n\t\tcategories : [\r\n\t\t\t{\r\n\t\t\t\tid \t\t: 'f11d24b3-be2f-4bdd-d0e0-2ebf9ba0f5c7',\r\n\t\t\t\tname \t: 'movies',\r\n\t\t\t\tfeeds \t: 0\r\n\t\t\t},{\r\n\t\t\t\tid \t\t: 'dd63224e-b59c-4b41-5f99-c63cffbbafe4',\r\n\t\t\t\tname \t: 'music',\r\n\t\t\t\tfeeds \t: 0\r\n\t\t\t},{\r\n\t\t\t\tid \t\t: '44748d67-be92-47a9-a5b6-de502f1e8cb5',\r\n\t\t\t\tname \t: 'software',\r\n\t\t\t\tfeeds \t: 0\r\n\t\t\t},{\r\n\t\t\t\tid \t\t: '91aa33c5-5099-48e8-b6a4-4a5946c0b617',\r\n\t\t\t\tname \t: 'others',\r\n\t\t\t\tfeeds \t: 0\r\n\t\t\t}\r\n\t\t],\r\n\t\tfeeds : [\r\n\t\t\t{\r\n\t\t\t\tid \t\t\t: 'a34d24b3-cc2f-6add-b2f0-5ebe9ac0f521',\r\n\t\t\t\tname \t\t: 'Mininova Movies',\r\n\t\t\t\turl \t\t: 'http://www.mininova.org/rss.xml?cat=4',\r\n\t\t\t\tproperies\t: ['title'],\r\n\t\t\t\tTTL \t\t: 10,\r\n\t\t\t\tcategories \t: ['f11d24b3-be2f-4bdd-d0e0-2ebf9ba0f5c7'],\r\n\t\t\t\tlastUpdate \t: null\r\n\t\t\t},{\r\n\t\t\t\tid \t\t\t: 'bdv424b6-cb1c-3aab-11b3-ac429bb0f530',\r\n\t\t\t\tname \t\t: 'YIFY Movies',\r\n\t\t\t\turl \t\t: 'https://yts.ag/rss',\r\n\t\t\t\tproperies\t: ['title'],\r\n\t\t\t\tTTL \t\t: 10,\r\n\t\t\t\tcategories \t: ['f11d24b3-be2f-4bdd-d0e0-2ebf9ba0f5c7'],\r\n\t\t\t\tlastUpdate \t: null\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\r\n\tgetCategoryById(id){\r\n\t\t\tlet i = this.Data.categories.findIndex( cat=>(cat.id === id ) ? true : false );\r\n\t\t\treturn (i === -1) ? -1 : this.Data.categories[i];\r\n\t},\r\n\r\n\tgetCategoryByName(id){\r\n\t\tlet i = this.Data.categories.findIndex( cat=>(cat.name === id ) ? true : false );\r\n\t\treturn (i === -1) ? -1 : this.Data.categories[i];\r\n\t},\r\n\r\n\tcountFeedsinCategory(id){\r\n\t\tlet category = this.getCategoryById(id);\r\n\t\tif(category === -1) return -1;\r\n\r\n\t\tcategory.feeds = 0;\r\n\t\tfor (let i=0; i < this.Data.feeds.length; i++ ) if(this.Data.feeds[i].categories.indexOf(id) !== -1) category.feeds++;\r\n\t\treturn category.feeds;\r\n\t},\r\n\r\n\tcountFeedsinAllCategories(){\r\n\t\tfor (let i=0; i < this.Data.categories.length; i++ ) this.countFeedsinCategory( this.Data.categories[i].id );\r\n\t\treturn true;\r\n\t},\r\n\r\n\tgetAllFeeds(){\r\n\t\treturn new Promise( (_resolve, _reject)=>{\r\n\t\t\tpg.log('pg.updateAllFeeds(): Updating all Feeds...');\r\n\t\t\tvar currentFeed = -1;\r\n\t\t\t// Loop through the Feeds with array.reduce...\r\n\t\t\tthis.Data.feeds.reduce( (sequence) => {\r\n\t\t\t\treturn sequence.then( ()=> {\r\n\t\t\t\t\tcurrentFeed++;\r\n\t\t\t \t\treturn this.getFeed(currentFeed);\r\n\t\t\t\t}).then( (result)=> {\r\n\t\t\t\t\tif(result) pg.log('pg.updateAllFeeds(): Feed #'+ ( currentFeed + 1) +' ' + this.Data.feeds[currentFeed].name + ' UPDATED' );\r\n\t\t\t    \telse  pg.log('pg.updateAllFeeds(): Feed #'+ ( currentFeed + 1) +' ' + this.Data.feeds[currentFeed].name + ' FAILED' );\r\n\t\t\t  \t\tif( (currentFeed + 1)=== this.Data.feeds.length) _resolve();\r\n\t\t\t  \t});\r\n\t\t\t} , Promise.resolve());\r\n\t\t});\r\n\t},\r\n\r\n\r\n\tgetFeed(i){\r\n\t\treturn new Promise( (_resolve, _reject)=>{\r\n\t\t\tif(i === undefined || i === null || i === '') return _reject(-1);\r\n\r\n\t\t\t// get feed (allow feed array index or string url feed)\r\n\t\t\tlet feed;\r\n\t\t\tif( isNaN(i) && typeof i === 'string' ) feed = { url : i , name : '***'};\r\n\t\t\telse feed = this.Data.feeds[i];\r\n\r\n\t\t\t// block if requested feed does not exist\r\n\t\t\tif(feed === undefined) return _reject(-1);\r\n\r\n\t\t\tpg.log('pg.updateFeed() : Updating Feed from :'+ feed.url +' ( ' + feed.name + ' )' );\r\n\r\n\t\t\t//\r\n\t\t\t// Prepare Ajax request\r\n\t\t\t//\r\n\t\t\tlet request = new XMLHttpRequest();\r\n\t\t\trequest.open('get', feed.url, true);\r\n\r\n\t\t\t// RESPONSE OK\r\n\t\t\trequest.onload  = ()=>{\r\n\t\t\t\tlet parser = new DOMParser();\r\n\t\t\t   \tlet xmlDoc = parser.parseFromString(request.responseText,'text/xml');\r\n\t\t\t\tlet JSONxml = JSON.parseXML(xmlDoc);\r\n\r\n\t\t\t\trequest = null;\r\n\t\t\t\treturn _resolve(JSONxml);\r\n\t\t\t};\r\n\t\t\t// RESPONSE FAIL\r\n\t\t\trequest.onerror  = ()=>{\r\n\t\t\t\tpg.log('pg.getFeed(): Error on request.', request.statusText);\r\n\t\t\t\trequest = null;\r\n\t\t\t\treturn _resolve(false);\r\n\t\t\t};\r\n\t\t\t// Send Request\r\n\t\t\trequest.send(null);\r\n\t\t});\r\n\t},\r\n\r\n\ttoogleArrayItem(item, array, event, object){\r\n\t\tlet i = array.indexOf(item);\r\n\t\tif(i === -1) array.push(item);\r\n\t\telse array.splice(i, 1);\r\n\t\tconsole.log(arguments);\r\n\t}\r\n};\r\n\r\nexport default app;\r\n"]}