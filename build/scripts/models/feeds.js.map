{"version":3,"sources":["feeds.es6"],"names":[],"mappings":"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","file":"feeds.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass */\r\n\r\n\r\nlet app;\r\n\r\nlet feeds = {\r\n\t__constructor(){\r\n\t\treturn new Promise(function(resolve){\r\n\t\t\tpg.load.model('app').then( m =>{\r\n\t\t\t\tapp = m;\r\n\t\t\t\tresolve();\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tlocation : 'feeds/list',\r\n\tinitialize : function(){\r\n\t\tfeeds.location = 'feeds/list';\r\n\t},\r\n\r\n\tlist : {},\r\n\r\n\tform : {\r\n\t\tshow \t\t\t\t: 'feedDeclarationForm',\r\n\t\tmode \t\t\t\t: 'insert', // | update\r\n\t\ttitle: {\r\n\t\t\tinsert \t\t\t: 'New Feed :',\r\n\t\t\tupdate \t\t\t: 'Edit Feed :'\r\n\t\t},\r\n\r\n\t\tUI : {\r\n\t\t\tfeedDeclarationForm \t: null,\r\n\t\t\tfeedConfigurationForm \t: null,\r\n\t\t\tfeedUrl \t\t\t\t: null\r\n\t\t},\r\n\r\n\t\tis_feedSourceValid \t: undefined,\r\n\r\n\t\tData : {\r\n\t\t\tid \t\t\t\t: '',\r\n\t\t\tstep \t\t\t: '1',\r\n\t\t\tname \t\t\t: '',\r\n\t\t\turl \t\t\t: 'https://yts.ag/rss',\r\n\t\t\tcategories \t\t: [],\r\n\t\t\tTTL \t\t\t: 60,\r\n\t\t\tproperties \t\t: [],\r\n\t\t\tformError \t\t: false\r\n\t\t},\r\n\r\n\r\n\t\tinitialize :  function(mode = 'insert'){\r\n\t\t\tfeeds.location = 'feeds/form';\r\n\t\t\tfeeds.form.Data.formError = false;\r\n\r\n\r\n\t\t\tif(mode === 'insert'){\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\tvalidate_feedSource: function(){\r\n\t\t\tpg.log( 'feeds.form.validate_feedSource(): Validating RSS feed...' );\r\n\t\t\t// reset previous form validations\r\n\t\t\tfeeds.form.Data.formError = false;\r\n\t\t\tfeeds.form.UI.feedUrl.setCustomValidity('');\r\n\t\t\t// validate form\r\n\t\t\tif( !feeds.form.UI.feedDeclarationForm.checkValidity() ){\r\n\t\t\t\tpg.log( 'feeds.form.validate_feedSource(): Form validation failed...' );\r\n\t\t\t\tfeeds.form.Data.formError = 'Some fields are invalid.';\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// show loader\r\n\t\t\tpg.loader(feeds.form.UI.feedDeclarationForm).show('Validating Feed...');\r\n\r\n\t\t\t// asncronic feed url validation\r\n\t\t\tapp.getFeed(feeds.form.Data.url).then(function(result){\r\n\t\t\t\t// done! hide loader\r\n\t\t\t\tpg.loader(feeds.form.UI.feedDeclarationForm).hide();\r\n\t\t\t\t// block and return if failed\r\n\t\t\t\tif(!result){\r\n\t\t\t\t\tpg.log( 'feeds.form.validate_feedSource(): URL validation failed...' );\r\n\t\t\t\t\tfeeds.form.Data.formError = 'RSS Feed not found in URL.';\r\n\t\t\t\t\tfeeds.form.UI.feedUrl.setCustomValidity('RSS Feed not found in URL.');\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\t// succeed, get RSS feed item properties\r\n\t\t\t\tfor(let i in result.rss.channel.item[0]){\r\n\t\t\t\t \tif( result.rss.channel.item[0].hasOwnProperty(i) &&  i.charAt(0).match(/[A-Z|a-z]/i) ) this.helpers.feedProperties.push(i);\r\n\t\t\t\t}\r\n\t\t\t\tfeeds.form.show = 'form/config';\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tsave_feedDefinition: function(){\r\n\t\t\tvar feed = {\r\n\t\t\t\tid \t\t\t: '',\r\n\t\t\t\tname \t\t: '',\r\n\t\t\t\turl \t\t: '',\r\n\t\t\t\tproperies\t: [],\r\n\t\t\t\tTTL \t\t: 0,\r\n\t\t\t\tcategories \t: [],\r\n\t\t\t};\r\n\r\n\t\t\tfeed.id = pg.createGuid();\r\n\t\t\tfeed.name = this.form.name.trim();\r\n\t\t\tfeed.url = this.form.url.trim();\r\n\t\t\tfeed.categories = this.form.categories;\r\n\t\t\tfeed.TTL = this.form.TTL;\r\n\t\t\tfeed.properties = this.form.properties;\r\n\r\n\t\t\tview.feeds.push(feed);\r\n\t\t\tpg.countFeedsinAllCategories();\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\r\n\r\n\r\n\t}\r\n};\r\n\r\nexport default feeds;\r\n"]}