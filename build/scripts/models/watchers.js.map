{"version":3,"sources":["watchers.es6"],"names":[],"mappings":";;;;;;;;;AAKA,IAAI,YAAJ;;AAEA,IAAI,WAAW;AACd,cADc,2BACC;AACd,SAAO,IAAI,OAAJ,CAAY,UAAS,OAAT,EAAiB;AACnC,MAAG,IAAH,CAAQ,KAAR,CAAc,KAAd,EAAqB,IAArB,CAA2B,aAAI;AAC9B,UAAM,CAAN;AACA;AACA,IAHD;AAIA,GALM,CAAP;AAMA,EARa;;;AAUd,WAAW,eAVG;;AAYd,aAAa,sBAAU;AAAE,WAAS,IAAT,CAAc,UAAd;AAA6B,EAZxC;;AAcd,OAAO;AACN,UAAS,IADH;;AAGN,cAAc,sBAAyB;AAAA,OAAhB,IAAgB,yDAAT,QAAS;;AACtC,YAAS,QAAT,GAAoB,eAApB;AACA,GALK;;AAON,6BAA2B,mCAAS,EAAT,EAAY;AACtC,YAAS,IAAT,CAAc,MAAd,GAAuB,IAAI,cAAJ,CAAmB,EAAnB,CAAvB;AACA,YAAS,QAAT,GAAoB,sBAApB;AACA,GAVK;;AAYN,mBAAiB,yBAAS,EAAT,EAAY;AAC5B,OAAI,aAAJ,CAAkB,EAAlB;AACA,YAAS,IAAT,CAAc,UAAd;AACA;AAfK,EAdO;;AAgCd,OAAO;AACN,UAAa,wBADP;AAEN,QAAW,QAFL,E;AAGN,SAAY,KAHN;AAIN,SAAO;AACN,WAAY,eADN;AAEN,WAAY;AAFN,GAJD;;AASN,MAAK;AACJ,2BAA0B;AADtB,GATC;;AAaN,QAAO,EAbD;;AAgBN,cAAc,sBAAmB;AAAA,OAAV,EAAU,yDAAL,IAAK;;AAChC,OAAI,OAAO,IAAX,EAAiB;;AAEhB,QAAI,UAAU,IAAI,WAAJ,CAAgB,EAAhB,CAAd;AACA,QAAI,YAAY,CAAC,CAAjB,EAAoB,MAAM,IAAI,KAAJ,CAAU,+DAA8D,EAAxE,CAAN;AACpB,aAAS,IAAT,CAAc,IAAd,GAAqB,QAArB;AACA,aAAS,IAAT,CAAc,IAAd,GAAqB,OAArB;AACA,IAND,MAMK;;AAEJ,aAAS,IAAT,CAAc,IAAd,GAAuB,QAAvB;AACA,aAAS,IAAT,CAAc,IAAd,GAAuB,IAAI,YAAJ,EAAvB;AACA,aAAS,IAAT,CAAc,IAAd,CAAmB,EAAnB,GAAyB,GAAG,IAAH,EAAzB;AACA;;AAED,YAAS,IAAT,CAAc,KAAd,GAAuB,KAAvB;AACA,YAAS,QAAT,GAAsB,eAAtB;AACA,YAAS,IAAT,CAAc,2BAAd;AACA,UAAO,IAAP;AACA,GAlCK;;AAoCN,+BAA6B,uCAAU;AAAE,YAAS,IAAT,CAAc,MAAd,GAAuB,wBAAvB;AAAkD,GApCrF;;AAsCN,oCAAkC,4CAAU;AAC3C,MAAG,GAAH,CAAQ,qFAAR;;AAEA,OAAI,WAAJ,CAAgB;AACf,QAAI,SAAS,IAAT,CAAc,IAAd,CAAmB,EADR;AAEf,UAAM,SAAS,IAAT,CAAc,IAAd,CAAmB,IAFV;AAGf,gBAAc,SAAS,IAAT,CAAc,IAAd,CAAmB,UAHlB;AAIf,gBAAc,CACb;AACC,SAAK,OADN;AAEC,UAAM,SAAS,IAAT,CAAc,IAAd,CAAmB;AAF1B,KADa;AAJC,IAAhB;;AAYA,YAAS,QAAT,GAAoB,eAApB;AACA,UAAO,IAAP;AACA,GAvDK;;AAyDN,iCAA+B,yCAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCxC;AA7FK;AAhCO,CAAf;;kBAiIe,Q","file":"watchers.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass */\r\n\r\n\r\nlet app;\r\n\r\nlet watchers = {\r\n\t__constructor(){\r\n\t\treturn new Promise(function(resolve){\r\n\t\t\tpg.load.model('app').then( m =>{\r\n\t\t\t\tapp = m;\r\n\t\t\t\tresolve();\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tlocation : 'watchers/list',\r\n\r\n\tinitialize : function(){ watchers.list.initialize(); },\r\n\r\n\tlist : {\r\n\t\ttarget : null,\r\n\r\n\t\tinitialize :  function(mode = 'insert'){\r\n\t\t\twatchers.location = 'watchers/list';\r\n\t\t},\r\n\r\n\t\tshow_deleteWatchersDialog: function(id){\r\n\t\t\twatchers.list.target = app.getWatcherById(id);\r\n\t\t\twatchers.location = 'watchers/list_delete';\r\n\t\t},\r\n\r\n\t\tdelete_watchers: function(id){\r\n\t\t\tapp.deleteWatcher(id);\r\n\t\t\twatchers.list.initialize();\r\n\t\t}\r\n\t},\r\n\r\n\tform : {\r\n\t\tactive \t\t\t\t: 'watcherDeclarationForm',\r\n\t\tmode \t\t\t\t: 'insert', // | update\r\n\t\terror \t\t\t\t: false,\r\n\t\ttitle: {\r\n\t\t\tinsert \t\t\t: 'New Watcher :',\r\n\t\t\tupdate \t\t\t: 'Edit Watcher :'\r\n\t\t},\r\n\r\n\t\tUI : {\r\n\t\t\twatcherDeclarationForm \t: null\r\n\t\t},\r\n\r\n\t\tData : {},\r\n\r\n\r\n\t\tinitialize :  function(id = null){\r\n\t\t\tif( id !== null ){\r\n\t\t\t\t// EDIT MODE DETECTED! ... get Feed Data\r\n\t\t\t\tlet watcher = app.getFeedById(id);\r\n\t\t\t\tif( watcher === -1) throw new Error('watchers.form.initialize(): Can\\'t find Watcher with ID : '+ id);\r\n\t\t\t\twatchers.form.mode = 'update';\r\n\t\t\t\twatchers.form.Data = watcher;\r\n\t\t\t}else{\r\n\t\t\t\t// INSERT MODE DETECTED ... generate new Feed\r\n\t\t\t\twatchers.form.mode \t\t= 'insert';\r\n\t\t\t\twatchers.form.Data \t\t= app.emptyWatcher();\r\n\t\t\t\twatchers.form.Data.id \t= pg.guid();\r\n\t\t\t}\r\n\r\n\t\t\twatchers.form.error \t= false;\r\n\t\t\twatchers.location \t\t= 'watchers/form';\r\n\t\t\twatchers.form.show_watcherDeclarationForm();\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tshow_watcherDeclarationForm: function(){ watchers.form.active = 'watcherDeclarationForm'; },\r\n\r\n\t\tvalidate_watchersDeclarationForm: function(){\r\n\t\t\tpg.log( 'watchers.form.validate_watchersDeclarationForm(): Validating Watcher Declaration...' );\r\n\t\t\t// save feed Data\r\n\t\t\tapp.saveWatcher({\r\n\t\t\t\tid: watchers.form.Data.id,\r\n\t\t\t\tname: watchers.form.Data.name,\r\n\t\t\t\tcategories \t: watchers.form.Data.categories,\r\n\t\t\t\tdirectives \t: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tin : 'title',\r\n\t\t\t\t\t\thas : watchers.form.Data.directives\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t});\r\n\t\t\t// DONE! display ending message!\r\n\t\t\twatchers.location = 'watchers/list';\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tvalidate_feedAssignationsForm: function(){\r\n\t\t\t/*\r\n\t\t\tpg.log( 'feeds.form.validate_feedAssignationsForm(): Validating Feed Assignations...' );\r\n\t\t\t// reset previous form validations\r\n\t\t\tfeeds.form.error = false;\r\n\t\t\t// validate form\r\n\t\t\tif( !feeds.form.UI.feedAssignationsForm.checkValidity() ){\r\n\t\t\t\tpg.log( 'feeds.form.validate_feedAssignationsForm(): Form validation failed...' );\r\n\t\t\t\tfeeds.form.error = 'Some fields require your attention.';\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// save feed Data\r\n\t\t\tapp.saveFeed({\r\n\t\t\t\tid: feeds.form.Data.id,\r\n\t\t\t\tname: feeds.form.Data.name,\r\n\t\t\t\turl : feeds.form.Data.url,\r\n\t\t\t\tfields: {\r\n\t\t\t\t\tavailable: feeds.form.Data.fields.available,\r\n\t\t\t\t\tassignations: {\r\n\t\t\t\t\t\ttitle: feeds.form.Data.fields.assignations.title,\r\n\t\t\t\t\t\tmagnet: feeds.form.Data.fields.assignations.magnet,\r\n\t\t\t\t\t\turl: feeds.form.Data.fields.assignations.url\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tTTL: feeds.form.Data.TTL,\r\n\t\t\t\tcategories: feeds.form.Data.categories,\r\n\t\t\t\tstatus: {\r\n\t\t\t\t\tlastCheck: new Date(),\r\n\t\t\t\t\tcode: 200,\r\n\t\t\t\t\tdetails: undefined\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// DONE! display ending message!\r\n\t\t\tfeeds.location = 'feeds/form_completed';\r\n\t\t\treturn true;\r\n\t\t\t*/\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport default watchers;\r\n"]}