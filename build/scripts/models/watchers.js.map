{"version":3,"sources":["watchers.es6"],"names":["watchers","__constructor","Data","undefined","page","limit","sortBy","order","items","JSON","parse","stringify","pg","models","storage","firstIndex","lastIndex","length","slice","get","id","original","i","getIndexById","delete","Promise","resolve","console","log","splice","sync","then","save","watcher","new","guid","name","categories","directives","in","has","findIndex"],"mappings":";;;;;AAAA;AACA;AACA;;AAGA,IAAIA,WAAW;AACdC,cADc,2BACC,CAAE,CADH;;;AAGdC,OAAOC,SAHO;;AAKdC,KALc,kBAKyC;AAAA,MAAjDA,KAAiD,uEAA1C,CAA0C;;AAAA,MAAtCC,KAAsC,uEAAhC,EAAgC;AAAA,MAA5BC,MAA4B,uEAAnB,EAAmB;AAAA,MAAdC,KAAc,uEAAR,MAAQ;;AAChD;AACA,MAAIC,QAAQC,KAAKC,KAAL,CAAYD,KAAKE,SAAL,CAAeC,GAAGC,MAAH,CAAUC,OAAV,CAAkBZ,IAAlB,CAAuBF,QAAtC,CAAZ,CAAZ;;AAEA;AACA;;AAEH;AACG,MAAGI,QAAO,CAAV,EAAY;AACX,OAAIW,aAAcX,QAAOC,KAAR,GAAiBA,KAAlC;AACA,OAAIW,YAAaD,aAAaV,KAAb,GAAqB,CAAtB,GAA2BG,MAAMS,MAAjC,GAA2CF,aAAaV,KAAxD,GAAkEG,MAAMS,MAAxF;AACAT,WAAQA,MAAMU,KAAN,CAAYH,UAAZ,EAAwBC,SAAxB,CAAR;AACA;AACD;AACA,SAAOR,KAAP;AACH,EApBU;AAsBXW,IAtBW,iBAsBgB;AAAA,MAAvBC,EAAuB,uEAApB,EAAoB;AAAA,MAAjBC,QAAiB,uEAAN,KAAM;;AAC7B,MAAIC,IAAItB,SAASuB,YAAT,CAAsBH,EAAtB,CAAR;AACA,SAAQE,MAAM,CAAC,CAAR,GAAa,CAAC,CAAd,GAAqBD,WAAWT,GAAGC,MAAH,CAAUC,OAAV,CAAkBZ,IAAlB,CAAuBF,QAAvB,CAAgCsB,CAAhC,CAAX,GAAgDb,KAAKC,KAAL,CAAYD,KAAKE,SAAL,CAAeC,GAAGC,MAAH,CAAUC,OAAV,CAAkBZ,IAAlB,CAAuBF,QAAvB,CAAgCsB,CAAhC,CAAf,CAAZ,CAA5E;AACA,EAzBa;AA4BXE,OA5BW,qBA4BE;AAAA,MAANJ,EAAM,uEAAH,EAAG;;AACT,SAAO,IAAIK,OAAJ,CAAY,UAASC,OAAT,EAAiB;AACtCC,WAAQC,GAAR,CAAY,kDAAgDR,EAA5D;AACH;AACA,OAAIE,IAAItB,SAASuB,YAAT,CAAsBH,EAAtB,CAAR;AACA;AACA,OAAGE,MAAM,CAAC,CAAV,EAAaI,QAAQ,KAAR;AACb;AACAd,MAAGC,MAAH,CAAUC,OAAV,CAAkBZ,IAAlB,CAAuBF,QAAvB,CAAgC6B,MAAhC,CAAuCP,CAAvC,EAAyC,CAAzC;AACA;AACAV,MAAGC,MAAH,CAAUC,OAAV,CAAkBgB,IAAlB,CAAuB9B,QAAvB,GAAkC+B,IAAlC,CAAwC;AAAA,WAAKL,QAAQ,IAAR,CAAL;AAAA,IAAxC;AACA,GAVY,CAAP;AAWH,EAxCU;AA0CdM,KA1Cc,gBA0CRC,OA1CQ,EA0CC;AACR,SAAO,IAAIR,OAAJ,CAAY,UAASC,OAAT,EAAiB;AACzCC,WAAQC,GAAR,CAAY,8CAA8CK,QAAQb,EAAlE;AACAO,WAAQC,GAAR,CAAYK,OAAZ;AACA,OAAIX,IAAItB,SAASuB,YAAT,CAAsBU,QAAQb,EAA9B,CAAR;AACA,OAAGE,MAAM,CAAC,CAAV,EAAaA,IAAIV,GAAGC,MAAH,CAAUC,OAAV,CAAkBZ,IAAlB,CAAuBF,QAAvB,CAAgCiB,MAApC;AACbL,MAAGC,MAAH,CAAUC,OAAV,CAAkBZ,IAAlB,CAAuBF,QAAvB,CAAgCsB,CAAhC,IAAqCW,OAArC;AACArB,MAAGC,MAAH,CAAUC,OAAV,CAAkBgB,IAAlB,CAAuB9B,QAAvB,GAAkC+B,IAAlC,CAAwC;AAAA,WAAKL,QAAQ,IAAR,CAAL;AAAA,IAAxC;AACA,GAPY,CAAP;AAQN,EAnDa;AAsDdQ,IAtDc,kBAsDT;AACJ,SAAO;AACNd,OAAQR,GAAGuB,IAAH,EADF;AAELC,SAASjC,SAFJ;AAGNkC,eAAc,EAHR;AAINC,eAAc,CACb;AACCC,QAAM,OADP;AAECC,SAAMrC;AAFP,IADa;AAJR,GAAP;AAWA,EAlEa;AAoEdoB,aApEc,wBAoEDH,EApEC,EAoEE;AACf,SAAOR,GAAGC,MAAH,CAAUC,OAAV,CAAkBZ,IAAlB,CAAuBF,QAAvB,CAAgCyC,SAAhC,CAA2C;AAAA,UAAUR,QAAQb,EAAR,KAAeA,EAAhB,GAAuB,IAAvB,GAA8B,KAAvC;AAAA,GAA3C,CAAP;AACA;AAtEa,CAAf;;kBAyEepB,Q","file":"watchers.js","sourcesContent":["/* jsHint inline configuration : */\n/* jshint undef: true, unused: false */\n/* global chrome , System , pg , rivets , sightglass */\n\n\nlet watchers = {\n\t__constructor(){},\n\n\tData : undefined,\n\n\tpage( page = 0 , limit=10, sortBy = '' , order='DESC' ){\n        // get all items (clone array)\n        let items = JSON.parse( JSON.stringify(pg.models.storage.Data.watchers) );\n\n        // TO DO : sort by key\n        // TO DO : apply ASC DESC order\n\n    \t// if a page is requested, slice array , and select only corresponding items\n        if(page > 0){\n        \tlet firstIndex = (page * limit) - limit;\n        \tlet lastIndex = (firstIndex + limit - 1) < items.length ? (firstIndex + limit ) : items.length ;\n        \titems = items.slice(firstIndex, lastIndex);\n        }\n        // done ! return items;\n        return items;\n    },\n\n    get(id='',original = false){\n\t\tlet i = watchers.getIndexById(id);\n\t\treturn (i === -1) ? -1 :  ( original ? pg.models.storage.Data.watchers[i] : JSON.parse( JSON.stringify(pg.models.storage.Data.watchers[i]) ) );\n\t},\n\n\n    delete(id=''){\n        return new Promise(function(resolve){\n\t    \tconsole.log('[Model]:watchers.delete(): deleting watcher #'+id);\n\t\t\t// get index in array\n\t\t\tlet i = watchers.getIndexById(id);\n\t\t\t// block if  id NOT found\n\t\t\tif(i === -1) resolve(false);\n\t\t\t// remove item from Data array\n\t\t\tpg.models.storage.Data.watchers.splice(i,1);\n\t\t\t// request to save new data\n\t\t\tpg.models.storage.sync.watchers().then( r => resolve(true) );\n\t\t});\n    },\n\n\tsave( watcher ){\n        return new Promise(function(resolve){\n\t\t\tconsole.log('[Model]:watchers.save(): saving watcher #' + watcher.id);\n\t\t\tconsole.log(watcher);\n\t\t\tlet i = watchers.getIndexById(watcher.id);\n\t\t\tif(i === -1) i = pg.models.storage.Data.watchers.length;\n\t\t\tpg.models.storage.Data.watchers[i] = watcher;\n\t\t\tpg.models.storage.sync.watchers().then( r => resolve(true) );\n\t\t});\n\t},\n\n\n\tnew(){\n\t\treturn {\n\t\t\tid \t\t\t: pg.guid(),\n\t\t \tname \t\t: undefined,\n\t\t\tcategories \t: [],\n\t\t\tdirectives \t: [\n\t\t\t\t{\n\t\t\t\t\tin \t: 'title',\n\t\t\t\t\thas : undefined\n\t\t\t\t}\n\t\t\t],\n\t\t};\n\t},\n\n\tgetIndexById(id){\n\t\treturn pg.models.storage.Data.watchers.findIndex( watcher=>(watcher.id === id ) ? true : false );\n\t},\n};\n\nexport default watchers;\n"]}