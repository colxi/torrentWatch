{"version":3,"sources":["watchers.es6"],"names":[],"mappings":"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","file":"watchers.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass */\r\n\r\n\r\nlet watchers = {\r\n\t__constructor(){},\r\n\r\n\tData : undefined,\r\n\r\n\tpage( page = 0 , limit=10, sortBy = '' , order='DESC' ){\r\n        // get all items (clone array)\r\n        let items = JSON.parse( JSON.stringify(pg.models.storage.Data.watchers) );\r\n\r\n        // TO DO : sort by key\r\n        // TO DO : apply ASC DESC order\r\n\r\n    \t// if a page is requested, slice array , and select only corresponding items\r\n        if(page > 0){\r\n        \tlet firstIndex = (page * limit) - limit;\r\n        \tlet lastIndex = (firstIndex + limit - 1) < items.length ? (firstIndex + limit ) : items.length ;\r\n        \titems = items.slice(firstIndex, lastIndex);\r\n        }\r\n        // done ! return items;\r\n        return items;\r\n    },\r\n\r\n    get(id='',original = false){\r\n\t\tlet i = watchers.getIndexById(id);\r\n\t\treturn (i === -1) ? -1 :  ( original ? pg.models.storage.Data.watchers[i] : JSON.parse( JSON.stringify(pg.models.storage.Data.watchers[i]) ) );\r\n\t},\r\n\r\n\r\n    delete(id=''){\r\n        return new Promise(function(resolve){\r\n\t    \tconsole.log('[Model]:watchers.delete(): deleting watcher #'+id);\r\n\t\t\t// get index in array\r\n\t\t\tlet i = watchers.getIndexById(id);\r\n\t\t\t// block if  id NOT found\r\n\t\t\tif(i === -1) resolve(false);\r\n\t\t\t// remove item from Data array\r\n\t\t\tpg.models.storage.Data.watchers.splice(i,1);\r\n\t\t\t// request to save new data\r\n\t\t\tpg.models.storage.sync.watchers().then( r => resolve(true) );\r\n\t\t});\r\n    },\r\n\r\n\tsave( watcher ){\r\n        return new Promise(function(resolve){\r\n\t\t\tconsole.log('[Model]:watchers.save(): saving watcher #' + watchers.id);\r\n\t\t\tlet i = watchers.getIndexById(watcher.id);\r\n\t\t\tif(i === -1) i = pg.models.storage.Data.watchers.length;\r\n\t\t\tpg.models.storage.Data.watchers[i] = watcher;\r\n\t\t\tpg.models.storage.sync.watchers().then( r => resolve(true) );\r\n\t\t});\r\n\t},\r\n\r\n\r\n\tnew(){\r\n\t\treturn {\r\n\t\t\tid \t\t\t: pg.guid(),\r\n\t\t \tname \t\t: undefined,\r\n\t\t\tcategories \t: [],\r\n\t\t\tdirectives \t: [\r\n\t\t\t\t{\r\n\t\t\t\t\tin \t: 'title',\r\n\t\t\t\t\thas : undefined\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t};\r\n\t},\r\n\r\n\tgetIndexById(id){\r\n\t\treturn pg.models.storage.Data.watchers.findIndex( watcher=>(watcher.id === id ) ? true : false );\r\n\t},\r\n};\r\n\r\nexport default watchers;\r\n"]}