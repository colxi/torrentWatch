{"version":3,"sources":["pomegranade.es6"],"names":[],"mappings":"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","file":"pomegranade.js","sourcesContent":["/* jsHint inline configuration : */\n/* jshint undef: true, unused: false */\n/* global chrome , System , rivets , sightglass */\n\nlet pg = {\n\t/**\n\t * [config description]\n\t * @type {Object}\n\t */\n\tconfig : {\n\t\tbaseUrl_import \t\t\t: '/',\n\t\tbaseUrl_controller \t\t: 'scripts/controllers/',\n\t\tbaseUrl_model \t\t\t: 'scripts/models/',\n\t\tbaseUrl_module \t\t\t: 'scripts/pg-modules/',\n\t\timports_constructor \t: '__constructor'\n\t},\n\t/**\n\t * [initialize description]\n\t * @return {[type]} [description]\n\t */\n\tinitialize : function(){\n\t\tpg.log('pg.initialize() : Pomegranade Object constructed. Initializing (pg.readyState=\"interactive\")');\n\t\tpg.readyState = 'interactive';\n\t\t/* ES6 polyfill */\n\t\tpg.require('imports/babel-polyfill/polyfill.min.js', 'Babel Polyfill...')\n\t\t\t// System js (import modules from the future)\n\t\t\t.then(r=> pg.require('imports/systemjs/system.js', 'SystemJS...') )\n\t\t\t/* Sightglass ... data binding */\n\t\t\t.then(r=> pg.require('imports/sightglass/index.js', 'Sightglass...') )\n\t\t\t/* Rivers data binding....*/\n\t\t\t.then(r=> pg.require('imports/rivets/rivets.js', 'Rivets...') )\n\t\t\t/* rivets expansion */\n  \t\t\t.then(r=> pg.require('lib/rivets.stdlib.js', 'Rivets Formaters Lib...') )\n\t\t\t/* rivets model and views importer */\n\t\t\t.then(r=> pg.require('lib/rivets-import-view-model.js', 'Rivets Model Importer Lib...') )\n\t\t\t/* modules configurations  */\n\t\t\t.then(r=>{\n\t\t\t\tpg.log('pg.initialize() : Configure Rivets & Rivets Model Importer...');\n\t\t\t\tSystem.config({ baseURL: pg.config.baseUrl_import });\n\t\t\t\t// configure RIVETS\n\t\t\t\trivets.configure({\n\t\t\t\t\tprefix: 'rv', \t\t\t\t\t// Attribute prefix in templates\n\t\t\t\t\tpreloadData: true,\t\t\t\t// Preload templates with initial data on bind\n\t\t\t\t\trootInterface: '.',\t\t\t\t// Root sightglass interface for keypaths\n\t\t\t\t\ttemplateDelimiters: ['{', '}'],\t// Template delimiters for text bindings\n\t\t\t\t\t// Augment the event handler of the on-* binder\n\t\t\t\t\thandler: function(target, ev, binding) { return this.call(target, event, binding.view.models,binding); }\n\t\t\t\t});\n\t\t\t\trivets.configure_importer({\n\t\t\t\t\tonLoadController : pg.load._onRivetsLoadController,\n\t\t\t\t\tbaseUrl : pg.config.baseUrl_controller,\n\t\t\t\t\tconstructor : pg.config.imports_constructor\n\t\t\t\t});\n\t\t\t\tpg.log('pg.initialize() : Integrate Binder in Pomegranade...');\n\t\t\t\tsightglass.adapters = rivets.adapters;\n\t\t\t\tsightglass.root \t= rivets.rootInterface;\n\t\t\t\t/* Ready ! Load main module */\n\t\t\t\tpg.log('pg.initialize() : Done! Pomegranade Ready! (pg.readyState=\"complete\")');\n\t\t\t\tpg.log('----------------------------------------------------------------------');\n\t\t\t\tpg.readyState = 'complete';\n\t\t\t\twhile( pg._readyCallbacks.length) ( pg._readyCallbacks.shift() )();\n\t\t\t});\n\t\treturn true;\n\t},\n\t/**\n\t * [ready description]\n\t * @param  {Function} callback [description]\n\t * @return {[type]}            [description]\n\t */\n\tready: function(callback){\n\t\tif(pg.readyState !== 'complete' || pg._readyCallbacks.length > 0) pg._readyCallbacks.push(callback);\n\t\telse callback();\n\t\treturn true;\n\t},\n\treadyState : 'loading',\n\t_readyCallbacks : [],\n\t/**\n\t * [load description]\n\t * @type {Object}\n\t */\n\tload :{\n\t\tpath_toArray( p='' ){\n\t\t\t// generate array from path and remove empty keys (caused by double // or ending /)\n\t\t\treturn p.split('/').filter( n=> (n === undefined || n === '') ? false : true );\n\t\t},\n\t\tpath_toObject( p='' , obj={} , canWrite = true){\n\t\t\tlet arrayPath = pg.load.path_toArray(p);\n\t\t\t// extract las item (module name reference)\n\t\t\tlet key = arrayPath.pop();\n\t\t\t// resolve module object instance path\n\t\t\tlet namespace = arrayPath.reduce( (o,i)=>{\n\t\t        if(o===false || ( o[i] === undefined && !canWrite ) ) return false;\n\t\t        if( o[i] === undefined) o[i] = {};\n\t\t        return  o[i];\n\t\t    }, obj );\n\t\t    namespace[key] = (typeof namespace[key] === 'object') ? namespace[key] : (canWrite ? {} : namespace[key]);\n\n\t\t    return{\n\t\t    \tpath \t\t: p,\n\t\t    \troot \t\t: obj,\n\t\t    \tkey \t\t: key,\n\t\t    \tnamespace \t: namespace,\n\t\t    \tobject \t\t: namespace[key]\n\t\t    };\n\t\t},\n\t\t_loaded : {\n\t\t\tmodule : {},\n\t\t\tmodel : {},\n\t\t\tcontroller : {}\n\t\t},\n\t\t_onRivetsLoadController(controllerName){\n\t\t\tpg.controllers[controllerName] = rivets.imports[controllerName];\n\t\t\tif(!pg.load._loaded['controller'].hasOwnProperty(controllerName)) pg.load._loaded['controller'][controllerName] = 1;\n\t\t\telse pg.load._loaded['controller'][controllerName]++;\n\t\t},\n\t\t_load(itemType = '', itemsList = [], containerObj = {}, returnArray = false ){\n\t\t\tpg.log('pg.load.'+itemType+'() : *** PREPARING TO LOAD ' + itemsList.length + ' '+itemType+'(s)...');\n\t\t\t// return promise\n\t\t\treturn new Promise(function(resolve_callback){\n\t\t\t\tlet results = [];\n\t\t\t\t// store loaded item object\n\t\t\t\tlet _constructed = function(item,_resolve){\n\t\t\t\t\tdelete item.__constructor; // ensure one time execution\n\t\t\t\t \treturn _resolve( item );\n\t\t\t\t};\n\t\t\t\t// loader function\n\t\t\t\tlet _loader = function(itemName = ''){\n\t\t\t\t\tpg.log('pg.load.'+itemType+'() : Loading '+ itemType +' : ' + itemName);\n\t\t\t\t\treturn new Promise(function(_resolve){\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// IMPORT ITEM\n\t\t\t\t\t\tif(!pg.load._loaded[itemType].hasOwnProperty(itemName)) pg.load._loaded[itemType][itemName] = 1;\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tpg.log('pg.load.'+itemType+'() : The '+ itemType +' ' + itemName + ' is already loaded. Using active Instance');\n\t\t\t\t\t\t\tpg.load._loaded[itemType][itemName]++;\n\t\t\t\t\t\t\treturn _resolve( pg.load.path_toObject(itemName, containerObj, false) );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tSystem.import(pg.config['baseUrl_'+itemType] + itemName +'.js').then( item => {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t// GENERATE ITEM INSTANCE\n\t\t\t\t\t\t\t// resolve item path into container object, creating tree if required\n\t\t\t\t\t\t\tif(itemType==='controller') rivets.imports[itemName] = item.default;\n\t\t\t\t\t\t\tlet objPath = pg.load.path_toObject(itemName, containerObj);\n\t\t\t\t\t\t\t// if item is a function assign to resolution path, if is an object, mix with existent object\n\t\t\t\t\t\t\tif(typeof item.default === 'function') objPath.namespace[objPath.key] = item.default;\n\t\t\t\t\t\t\telse objPath.object = Object.assign( objPath.object , item.default );\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t// EXECUTE CONSTRUCTOR\n\t\t\t\t\t\t\t// check if has custom constructor/igniter\n\t\t\t   \t\t\t\tif( objPath.object.hasOwnProperty(pg.config.imports_constructor) &&\n\t\t\t   \t\t\t\ttypeof objPath.object[pg.config.imports_constructor] === 'function' ){\n\t\t\t\t\t\t\t\tpg.log('pg.load.'+itemType+'() : Executing '+itemName+' constructor.' , 'info');\n\t\t   \t\t\t\t\t\t// execute CONTROLLER module custom constructor\n\t\t   \t\t\t\t\t\tlet _c = objPath.object[pg.config.imports_constructor].call( objPath.object );\n\t\t   \t\t\t\t\t\t// resolve pg.loadController (handle promise in CONTROLLER module __constructor)\n\t\t   \t\t\t\t\t\tif( typeof _c === 'object' && typeof _c.then === 'function'){\n\t\t\t\t\t\t\t\t\tpg.log('pg.load.'+itemType+'() : Detected Promise in '+itemName+' Constructor. Waiting resolution...' , 'info');\n\t\t   \t\t\t\t\t\t\treturn _c.then( x => _constructed(objPath.object,_resolve) );\n\t\t   \t\t\t\t\t\t}else{\n\t\t   \t\t\t\t\t\t\treturn _constructed(objPath.object,_resolve);\n\t\t   \t\t\t\t\t\t}\n\t\t\t   \t\t\t\t}else return _constructed(objPath.object,_resolve);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\t// promise sequential iterator\n\t\t\t\tfunction _next(){\n\t\t\t\t\t_loader( itemsList.shift() ).then( r =>{\n\t\t\t\t\t\tresults.push(r);\n\t\t\t\t\t\tif(itemsList.length === 0) resolve_callback( returnArray ? results : results[0] );\n\t\t\t\t\t\telse _next();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// start iteration\n\t\t\t\t_next();\n\t\t\t});\n\t\t},\n\t\tmodel(items = ''){\n\t\t\t// if more than one module has been requested, or single item has been requested inside array, return array\n\t\t\tlet returnArray = ( arguments.length > 1 || Array.isArray(items) ) ? true : false;\n\t\t\t// force items to be an array\n\t\t\titems = Array.isArray(items) ? items : Array.prototype.slice.call(arguments) ;\n\t\t\t// start load\n\t\t\treturn pg.load._load( 'model', items , pg.models , returnArray );\n\t\t},\n\t\tcontroller(items= ''){\n\t\t\t// if more than one module has been requested, or single item has been requested inside array, return array\n\t\t\tlet returnArray = ( arguments.length > 1 || Array.isArray(items) ) ? true : false;\n\t\t\t// force items to be an array\n\t\t\titems = Array.isArray(items) ? items : Array.prototype.slice.call(arguments) ;\n\t\t\t// start load\n\t\t\treturn pg.load._load( 'controller', items , pg.controllers , returnArray );\n\t\t},\n\t\tmodule(items = ''){\n\t\t\t// if more than one module has been requested, or single item has been requested inside array, return array\n\t\t\tlet returnArray = ( arguments.length > 1 || Array.isArray(items) ) ? true : false;\n\t\t\t// force items to be an array\n\t\t\titems = Array.isArray(items) ? items : Array.prototype.slice.call(arguments) ;\n\t\t\t// start load\n\t\t\treturn pg.load._load( 'module', items , pg , returnArray );\n\t\t},\n\t\tview : {},\n\t\thtml : {},\n\t\tcss  : {},\n\t},\n\n\tloader :function(el = document.body){\n\t\treturn {\n\t\t\tshow : function(text = ''){ el.setAttribute('pg-loading',text) },\n\t\t\thide : function(){ el.removeAttribute('pg-loading') },\n\t\t\ttext : function(text = ''){ el.setAttribute('pg-loading',text) },\n\t\t\thas : function(){ return el.hasAttribute('pg-loading') },\n\t\t};\n\t},\n\n\tconfigure : function(obj){} ,\n\n\t/**\n\t * [loadView description]\n\t * @param  {[type]} viewId [description]\n\t * @return {[type]}        [description]\n\t */\n\tloadView : function(viewId){\n\t\talert(\"pg.loadView() : just for testing\");\n\t\tlet path = 'views/pages/' + viewId + '.html';\n\t\treturn new Promise(function(_resolve){\n            let done = false;\n\t\t\tlet _html = new XMLHttpRequest();\n            _html.overrideMimeType('text/html');\n            _html.open('GET', path , true);\n            _html.onload = _html.onreadystatechange = function () {\n                if ( !done && (!this.readyState || this.readyState === 4) ) {\n                    done = true;\n                    // free memory, explicit  listener removal;\n                    _resolve(_html.responseText);\n                    _html.onload = _html.onreadystatechange = null;\n                }\n            };\n            _html.onerror = function(){ _resolve(false); };\n            _html.send(null);\n        });\n\t},\n\t/**\n\t * [controller description]\n\t * @type {Object}\n\t */\n\tviews : {},\n\tmodels : {},\n\tcontrollers : {},\n\t/**\n\t * [description]\n\t * @param  {[type]} )\n\t * @return {[type]}   [description]\n\t */\n\n\n\twatch : function(el, key, callback, options){\n\t\treturn sightglass(el, key, callback, options);\n\t},\n\tbindings : {},\n\tbind : function(el, data){\n\t\tvar view = rivets.bind(el,data);\n\t\tvar id = pg.guid();\n\t\tObject.defineProperty(view, '__pg_id__', {  value: id, enumerable: false, writable:false,  configurable: false });\n\t\tpg.bindings[id] = view;\n\t\treturn id;\n\t},\n\tunbind: function(id){\n\t\tif( pg.bindings.hasOwnProperty(id) ){\n\t\t\tpg.bindings[id].unbind();\n\t\t\tdelete pg.bindings[id];\n\t\t\treturn true;\n\t\t}else{\n\t\t\tconsole.warn('pg.unbind() : Provided binding ID does not match to any previous registered binding.');\n\t\t\treturn false;\n\t\t}\n\t},\n\tunbindAll: function(){\n\t\tpg.log('pg.unbindAll(): Unbinding all bindings ( pg.bind and rv:model:import)...');\n\t\t// automatic bindings in model imports....\n\t\tfor(var model in rivets.imports){\n\t\t\tif(!rivets.imports.hasOwnProperty(model) ) continue;\n\t\t\tconsole.log(model);\n\t\t\tfor(var view in rivets.imports[model].__views__){\n\t\t\t\tif(!rivets.imports[model].__views__.hasOwnProperty(view) ) continue;\n\t\t\t\trivets.imports[model].__views__[view].unbind();\n\t\t\t\tdelete rivets.imports[model].__views__[view];\n\t\t\t}\n\t\t}\n\t\t// manual bindings in in pomegradade...\n\t\tfor(var binding in pg.bindings){\n\t\t\tif(!pg.bindings.hasOwnProperty(binding) ) continue;\n\t\t\tconsole.log(binding);\n\t\t\tpg.unbind(binding);\n\t\t}\n\t\treturn true;\n\t},\n\n\t/**\n\t * [require description]\n\t * @param  {[type]} url [description]\n\t * @return {[type]}     [description]\n\t */\n\trequire: (function(){\n\t\tconst config = {\n\t\t\tbaseUrl : 'scripts/'\n\t\t};\n\t\tlet _require = function(src, description = '') {\n\t\t\tpg.log('pg.require() :'+ description + ' ' + src);\n\t    \treturn new Promise(function(_resolve, _reject){\n\t\t\t   \tlet filename = src.substring(src.lastIndexOf('/')+1);\n\t\t\t\t// if no extension, assume .JS and extract again the filenamename\n\t\t\t\tif(filename.lastIndexOf('.js') === -1){\n\t\t\t\t\tsrc = src + '.js';\n\t\t\t\t\tfilename = src.substring(src.lastIndexOf('/')+1);\n\t\t\t\t}\n\t\t\t    // Adding the script tag to the head\n\t\t\t    let done = false;\n\t\t\t    let head = document.getElementsByTagName('head')[0];\n\t\t\t    let script = document.createElement('script');\n\t\t\t    script.type = 'text/javascript';\n\t\t\t    script.src = config.baseUrl + src;\n\t\t\t    //pg.log(script.src);\n\t\t\t\tscript.onload = script.onreadystatechange = function() {\n\t\t\t\t\t// attach to both events for cross browser finish detection:\n\t\t\t\t\tif ( !done && (!this.readyState || this.readyState === 'loaded' || this.readyState === 'complete') ) {\n\t\t\t\t\t\t// done! execute PROMISE _resolve\n\t\t\t\t\t\tdone = true;\n\t\t\t\t\t\t// cleans up a little memory, removing listener;\n\t\t\t\t\t\tscript.onload = script.onreadystatechange = null;\n\t\t\t\t\t\t_resolve();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t    // Fire the loading\n\t\t\t    head.appendChild(script);\n\t\t\t});\n\t\t};\n\t\t_require.config = function(custom_config){\n\t\t\tObject.assign(config,custom_config);\n\t\t\treturn true;\n\t\t};\n\t\treturn _require;\n\t})(),\n\t/**\n\t * [feeds description]\n\t * @type {Array}\n\t */\n\n\tlogStore : [],\n\tlog : function(msg = '{empty}' , method = 'log'){\n\t\tpg.logStore.push(msg);\n\t\tconsole[method](msg);\n\t\treturn true;\n\t},\n\t/**\n\t * [createGuid description]\n\t * @return {[type]} [description]\n\t */\n\tguid : function(){\n\t\tfunction S4() {  return (((1+Math.random())*0x10000)|0).toString(16).substring(1) }\n\t\t\t// then to call it, plus stitch in '4' in the third group\n\t\treturn (S4() + S4() + '-' + S4() + '-4' + S4().substr(0,3) + '-' + S4() + '-' + S4() + S4() + S4()).toLowerCase();\n\t}\n};\n\nif(document.readyState === 'complete' || document.readyState === 'interactive') pg.initialize();\nelse document.addEventListener('DOMContentLoaded', pg.initialize );\n"]}