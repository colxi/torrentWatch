{"version":3,"sources":["categories.es6"],"names":[],"mappings":"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","file":"categories.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass */\r\n\r\n\r\nlet categories = {\r\n\t__constructor(){\r\n\t\treturn new Promise(function(resolve){\r\n\t\t\tpg.load.model('categories').then( r => resolve() );\r\n\t\t});\r\n\t},\r\n\r\n\tlocation : 'categories/list',\r\n\r\n\tinitialize : function(){ categories.list.initialize(); },\r\n\r\n\tlist : {\r\n\t\ttarget : null,\r\n\r\n\t\tpage:{\r\n\t\t\tcurrent \t: 1,\t// current page\r\n\t\t\ttotal \t\t: 1,\t// total pages\r\n\t\t\tlimit \t\t: 5,\t// limit of items\r\n\t\t\torder \t\t: 'DESC',\r\n\t\t\tsortBy \t\t: 'id',\r\n\t \t\titems \t\t: [],\r\n\t\t\tcount(){ return( categories.list.page.total = Math.ceil(pg.models.categories.page(0).length / categories.list.page.limit) )},\r\n\t\t\tupdate(){\r\n\t\t\t\tcategories.list.page.count();\r\n\t\t\t\tcategories.list.page.set(categories.list.page.current || 1);\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tset(num, modifier=0){\r\n\t\t\t\tnum = num + modifier;\r\n\t\t\t\t// validate pageNum\r\n\t\t\t\tif(typeof num !== 'number' || num < 1) num = 1;\r\n\t\t\t\telse if(num > categories.list.page.total) num = categories.list.page.count();\r\n\t\t\t\tcategories.list.page.current = Math.floor(num);\r\n\r\n\t\t\t\tcategories.list.page.items = pg.models.categories.page(categories.list.page.current, categories.list.page.limit);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tinitialize :  function(mode = 'insert'){\r\n\t\t\tcategories.list.page.set(1);\r\n\t\t\tcategories.list.show();\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tshow : function(){\r\n\t\t\tcategories.list.page.update();\r\n\t\t\tcategories.location = 'categories/list';\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tshow_deleteCategoryDialog: function(id){\r\n\t\t\tcategories.list.target = pg.models.categories.get(id);\r\n\t\t\tcategories.location = 'categories/list_delete';\r\n\t\t},\r\n\r\n\t\tdelete_category: function(id){\r\n\t\t\tpg.models.categories.delete(id);\r\n\t\t\tcategories.list.show();\r\n\t\t}\r\n\t},\r\n\r\n\tform : {\r\n\t\tactive \t\t\t\t: 'categoryDeclarationForm',\r\n\t\tmode \t\t\t\t: 'insert', // | update\r\n\t\terror \t\t\t\t: false,\r\n\t\ttitle: {\r\n\t\t\tinsert \t\t\t: 'New Category :',\r\n\t\t\tupdate \t\t\t: 'Edit Category :'\r\n\t\t},\r\n\r\n\t\tUI : {\r\n\t\t\tcategoryDeclarationForm : null,\r\n\t\t\tcategoryName \t\t\t: null\r\n\t\t},\r\n\r\n\t\tData : {},\r\n\r\n\r\n\t\tinitialize :  function(id = null){\r\n\t\t\tif( id !== null ){\r\n\t\t\t\t// EDIT MODE DETECTED! ... get Category Data\r\n\t\t\t\tlet category = pg.models.categories.get(id);\r\n\t\t\t\tif( category === -1) throw new Error('categories.form.initialize(): Can\\'t find Category with ID : '+ id);\r\n\t\t\t\tcategories.form.mode = 'update';\r\n\t\t\t\tcategories.form.Data = category;\r\n\t\t\t}else{\r\n\t\t\t\t// INSERT MODE DETECTED ... generate new Category\r\n\t\t\t\tcategories.form.mode \t\t= 'insert';\r\n\t\t\t\tcategories.form.Data \t\t= pg.models.categories.new();\r\n\t\t\t}\r\n\r\n\t\t\tcategories.form.error \t= false;\r\n\t\t\tcategories.location \t= 'categories/form';\r\n\t\t\tcategories.form.show_categoryDeclarationForm();\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tshow_categoryDeclarationForm: function(){ categories.form.active = 'categoryDeclarationForm'; },\r\n\r\n\t\tvalidate_categoryDeclarationForm: function(){\r\n\t\t\tpg.log( 'categories.form.validate_categoryDeclarationForm(): Validating Category Declaration...' );\r\n\t\t\t// reset previous form validations\r\n\t\t\tcategories.form.error = false;\r\n\t\t\tcategories.form.UI.categoryName.setCustomValidity('');\r\n\t\t\t// validate form\r\n\r\n\t\t\tcategories.form.Data.name = (categories.form.Data.name || '').trim().toLowerCase();\r\n\r\n\t\t\tif( !categories.form.UI.categoryDeclarationForm.checkValidity() ){\r\n\t\t\t\tpg.log( 'categories.form.validate_categoryDeclarationForm(): Form validation failed...' );\r\n\t\t\t\tcategories.form.error = 'Some fields require your attention.';\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// show loader\r\n\t\t\tpg.loader(categories.form.UI.categoryDeclarationForm).show();\r\n\t\t\t//\r\n\t\t\t// validation : duplicated name\r\n\t\t\t//\r\n\t\t\tif( pg.models.categories.getByName(categories.form.Data.name) !== -1 ){\r\n\t\t\t\t// if has same ID as duplicated, means is updating entry.... ignore and continue\r\n\t\t\t\tif( pg.models.categories.getByName(categories.form.Data.name).id !== categories.form.Data.id ){\r\n\t\t\t\t\tpg.log( 'categories.form.validate_categoryDeclarationForm(): Name validation failed...' );\r\n\t\t\t\t\tcategories.form.error = 'Category name already exist.';\r\n\t\t\t\t\tcategories.form.UI.categoryName.setCustomValidity('Category name already exist.');\r\n\t\t\t\t\tpg.loader(categories.form.UI.categoryDeclarationForm).hide();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// not duplicated! save...\r\n\t\t\tpg.models.categories.save({\r\n\t\t\t\tid: categories.form.Data.id,\r\n\t\t\t\tname: categories.form.Data.name,\r\n\t\t\t\tcount : 0\r\n\t\t\t}).then( r=> {\r\n\t\t\t\t//  hide loader\r\n\t\t\t\tpg.loader(categories.form.UI.categoryDeclarationForm).hide();\r\n\t\t\t\t// DONE! display ending message!\r\n\t\t\t\tcategories.location = 'categories/form_completed';\r\n\t\t\t});\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport default categories;\r\n\r\n"]}