{"version":3,"sources":["categories.es6"],"names":[],"mappings":"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","file":"categories.js","sourcesContent":["/* jsHint inline configuration : */\r\n/* jshint undef: true, unused: false */\r\n/* global chrome , System , pg , rivets , sightglass */\r\n\r\n\r\nlet app;\r\n\r\nlet categories = {\r\n\t__constructor(){\r\n\t\treturn new Promise(function(resolve){\r\n\t\t\tpg.load.controller('app').then( m =>{\r\n\t\t\t\tapp = m;\r\n\t\t\t\tresolve();\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tlocation : 'categories/list',\r\n\r\n\tinitialize : function(){ categories.list.initialize(); },\r\n\r\n\tlist : {\r\n\t\ttarget : null,\r\n\r\n\t\tinitialize :  function(mode = 'insert'){\r\n\t\t\tcategories.location = 'categories/list';\r\n\t\t},\r\n\r\n\t\tshow_deleteCategoryDialog: function(id){\r\n\t\t\tcategories.list.target = app.getCategoryById(id);\r\n\t\t\tcategories.location = 'categories/list_delete';\r\n\t\t},\r\n\r\n\t\tdelete_category: function(id){\r\n\t\t\tapp.deleteCategory(id);\r\n\t\t\tcategories.list.initialize();\r\n\t\t}\r\n\t},\r\n\r\n\tform : {\r\n\t\tactive \t\t\t\t: 'categoryDeclarationForm',\r\n\t\tmode \t\t\t\t: 'insert', // | update\r\n\t\terror \t\t\t\t: false,\r\n\t\ttitle: {\r\n\t\t\tinsert \t\t\t: 'New Category :',\r\n\t\t\tupdate \t\t\t: 'Edit Category :'\r\n\t\t},\r\n\r\n\t\tUI : {\r\n\t\t\tcategoryDeclarationForm : null,\r\n\t\t\tcategoryName \t\t\t: null\r\n\t\t},\r\n\r\n\t\tData : {},\r\n\r\n\r\n\t\tinitialize :  function(id = null){\r\n\t\t\tif( id !== null ){\r\n\t\t\t\t// EDIT MODE DETECTED! ... get Category Data\r\n\t\t\t\tlet category = app.getCategoryById(id);\r\n\t\t\t\tif( category === -1) throw new Error('categories.form.initialize(): Can\\'t find Category with ID : '+ id);\r\n\t\t\t\tcategories.form.mode = 'update';\r\n\t\t\t\tcategories.form.Data = category;\r\n\t\t\t}else{\r\n\t\t\t\t// INSERT MODE DETECTED ... generate new Category\r\n\t\t\t\tcategories.form.mode \t\t= 'insert';\r\n\t\t\t\tcategories.form.Data \t\t= app.emptyCategory();\r\n\t\t\t\tcategories.form.Data.id \t= pg.guid();\r\n\t\t\t}\r\n\r\n\t\t\tcategories.form.error \t= false;\r\n\t\t\tcategories.location \t= 'categories/form';\r\n\t\t\tcategories.form.show_categoryDeclarationForm();\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tshow_categoryDeclarationForm: function(){ categories.form.active = 'categoryDeclarationForm'; },\r\n\r\n\t\tvalidate_categoryDeclarationForm: function(){\r\n\t\t\tpg.log( 'categories.form.validate_categoryDeclarationForm(): Validating Category Declaration...' );\r\n\t\t\t// reset previous form validations\r\n\t\t\tcategories.form.error = false;\r\n\t\t\tcategories.form.UI.categoryName.setCustomValidity('');\r\n\t\t\t// validate form\r\n\r\n\t\t\tcategories.form.Data.name = categories.form.Data.name.trim().toLowerCase();\r\n\r\n\t\t\tif( !categories.form.UI.categoryDeclarationForm.checkValidity() ){\r\n\t\t\t\tpg.log( 'categories.form.validate_categoryDeclarationForm(): Form validation failed...' );\r\n\t\t\t\tcategories.form.error = 'Some fields require your attention.';\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// show loader\r\n\t\t\tpg.loader(categories.form.UI.categoryDeclarationForm).show('Validating Category Source...');\r\n\t\t\t//\r\n\t\t\t// validation : duplicated name\r\n\t\t\t//\r\n\t\t\tif( app.getCategoryByName(categories.form.Data.name) !== -1 ){\r\n\t\t\t\t// if has same ID as duplicated, means is updating entry.... ignore and continue\r\n\t\t\t\tif( app.getCategoryByName(categories.form.Data.name).id !== categories.form.Data.id ){\r\n\t\t\t\t\tpg.log( 'categories.form.validate_categoryDeclarationForm(): Name validation failed...' );\r\n\t\t\t\t\tcategories.form.error = 'Category name already exist.';\r\n\t\t\t\t\tcategories.form.UI.categoryName.setCustomValidity('Category name already exist.');\r\n\t\t\t\t\tpg.loader(categories.form.UI.categoryDeclarationForm).hide();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// not duplicated! save...\r\n\t\t\tapp.saveCategory({\r\n\t\t\t\tid: categories.form.Data.id,\r\n\t\t\t\tname: categories.form.Data.name,\r\n\t\t\t\tcount : 0\r\n\t\t\t});\r\n\t\t\t//  hide loader\r\n\t\t\tpg.loader(categories.form.UI.categoryDeclarationForm).hide();\r\n\t\t\t// DONE! display ending message!\r\n\t\t\tcategories.location = 'categories/form_completed';\r\n\t\t\treturn true;\r\n\t\t},\r\n\t}\r\n};\r\n\r\nexport default categories;\r\n\r\n"]}